\begin{figure}[!ht]
    \centering
    \vspace{0.2cm}

    \begin{tikzpicture}[scale=1]
    \ctikzset{tripoles/mos style/arrows}
    \ctikzset{tripoles/pmos style/emptycircle}
    \ctikzset{logic ports=ieee}

    % Stage 1
    \begin{scope}[shift={(0,0)}, name=stage1]
    \draw 
    (0,0) --++ (0,-0.5) node[nmos, anchor=D] (M1) {$\text{M}_1$} % NMOS transistor
    (M1.S) node[ground] {} % Ground connection
    (M1.D) --++ (0,0.5) to[R, l=$R_D$] (0,2) node[rground, rotate=180] {} ++ (0,0.7) node (anchor=south)(Vdd) {$V_\text{DD}$} % Resistor connected to Vdd
    (M1.G) --++ (-0.5,0) node[anchor=south west] (X) {$X$}
    (M1.G) --++ (-1,0) node[circle, anchor=center] (G1) {}
    (M1.D) to [short, *-] (1.5, -0.5) node[circ] (V1) {} % Output node
    to[C, l=$C_L$] (V1 |- M1.S) node[ground] {}; % Capacitor connected to ground
    \end{scope}

    % Stage 2
    \begin{scope}[shift={(5,0)}, name=stage2]
    \draw 
    (0,0) --++ (0,-0.5) node[nmos, anchor=D] (M2) {$\text{M}_2$} % NMOS transistor
    (M2.S) node[ground] {} % Ground connection
    (M2.D) --++ (0,0.5) to[R, l=$R_D$] (0,2) node[rground, rotate=180] {} ++ (0,0.7) node (anchor=south)(Vdd) {$V_\text{DD}$} % Resistor connected to Vdd
    (M2.G) --++ (-0.5,0) node[anchor=south west] (Y) {$Y$}
    (M2.G) --++ (-0.7,0) node[circle, anchor=center] (G2) {}
    (M2.D) to [short, *-] (1.5, -0.5) node[circ] (V2) {} % Output node
    to[C, l=$C_L$] (V2 |- M2.S) node[ground] {}; % Capacitor connected to ground
    \end{scope}

    % Stage 3
    \begin{scope}[shift={(10,0)}, name=stage3]
    \draw 
    (0,0) --++ (0,-0.5) node[nmos, anchor=D] (M3) {$\text{M}_3$} % NMOS transistor
    (M3.S) node[ground] {} % Ground connection
    (M3.D) --++ (0,0.5) to[R, l=$R_D$] (0,2) node[rground, rotate=180] {} ++ (0,0.7) node (anchor=south)(Vdd) {$V_\text{DD}$} % Resistor connected to Vdd
    (M3.G) --++ (-0.5,0) node[anchor=south west] (Z) {$Z$}
    (M3.G) --++ (-0.7,0) node[circle, anchor=center] (G3) {}
    (M3.D) to [short, *-] (1.5, -0.5) node[circ] (V3) {} % Output node
    to[C, l=$C_L$] (V3 |- M3.S) node[ground] {}; % Capacitor connected to ground
    \end{scope}

    \draw (V1) -| (G2.center);
    \draw (V2) -| (G3.center);
    \draw (V3) --++ (1.8,0) --++ (0,-3.5) -| (G1.center);

    \draw[dashed] (-1.6,0) --++ (0,3.3) node[anchor=south west] (H) {$-H(s)$} --++ (14.5,0) --++ (0,-6.5) --++ (-14.5,0) --++ (0,3.2);

    \end{tikzpicture}
    \vspace{0.2cm}
    \caption{Три степена са заједничким извором у повратној спрези.}
    \label{ring_osc_1}
\end{figure}
